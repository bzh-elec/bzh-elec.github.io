!function(){var i,c=(i={},function(t){var a=$.Deferred();return t in i?i[t]?a.resolve(i[t]):a.reject("Preview image not found."):$("<img>").on("load",function(){if(120===(this.naturalWidth||this.width)){var e=this.src.split("/").pop();switch(e){case"maxresdefault.jpg":this.src=this.src.replace(e,"sddefault.jpg");break;case"sddefault.jpg":this.src=this.src.replace(e,"hqdefault.jpg");break;case"hqdefault.jpg":this.src=this.src.replace(e,"default.jpg");break;default:i[t]=null,a.reject("Preview image not found.")}}else a.resolve(i[t]=this.src)}).attr("src","https://img.youtube.com/vi/"+t+"/maxresdefault.jpg"),a});$("html").hasClass("is-builder")||$(document).on("add.cards",function(e){var r;$(e.target).hasClass("carousel")&&(r=$("html").hasClass("desktop"),$(e.target).outerFind("[data-bg-video-slide]").each(function(){var t,e,a,i,s,o="false"!==(e=$(this).attr("data-bg-video-slide"))&&(!!(e=e.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(&\S+)?/))&&e[6]);o&&(t=$('<div class="mbr-background-video-preview"></div>').css({display:"none",backgroundSize:"cover",backgroundPosition:"center"}),$(".container-slide",this).before(t),i="false"!==(s=$(this).attr("data-bg-video-slide"))&&((s=s.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(&\S+)?/))&&/youtu\.?be/g.test(s[3])?"youtube":!(!s||!/vimeo/g.test(s[3]))&&"vimeo"),e=$(this).find(".mbr-overlay"),"youtube"===i?(c(o).done(function(e){t.css("background-image",'url("'+e+'")').show()}),r&&$.fn.YTPlayer&&!$(this).find(".playerBox").length&&($(".container-slide",this).before('<div class="mbr-background-video"></div>').prev().YTPlayer({videoURL:o,containment:"self",showControls:!1,mute:!0}),e.length&&$(".YTPOverlay",this).css({opacity:e.css("opacity"),backgroundColor:e.css("background-color")}),$(this).find(".image_wrapper img").css("opacity","0"),$(this).find(".image_wrapper .mbr-overlay").css("opacity","0"))):(s=o,a=function(e){t.css("background-image",'url("'+e+'")').show()},(i=new XMLHttpRequest).open("GET","https://vimeo.com/api/v2/video/"+s+".json",!0),i.onreadystatechange=function(){var e;4===this.readyState&&200<=this.status&&this.status<400&&(e=JSON.parse(this.responseText),a(e[0].thumbnail_large))},i.send(),i=null,r&&$.fn.vimeo_player&&!$(this).find(".playerBox").length&&($(".container-slide",this).before('<div class="mbr-background-video"></div>').prev().vimeo_player({videoURL:o,containment:"self",showControls:!1,mute:!0}),e.length&&$(".vimeo_player_overlay",this).css({opacity:e.css("opacity"),backgroundColor:e.css("background-color")}))))}),$(e.target).find(".carousel-item iframe").css({transitionProperty:"opacity",transitionDuration:"1000ms"}),$(this).on("slide.bs.carousel","section.carousel",function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each(function(){$(this).YTPPause()}),$(e.target).find(".carousel-item.active .vimeo_player").each(function(){$(this).v_pause()}),$(e.target).find(".carousel-item:not(.active) iframe").css("opacity",0)}),$(this).on("slid.bs.carousel","section.carousel",function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each(function(){$(this).YTPPlay()}),$(e.target).find(".carousel-item.active .vimeo_player").each(function(){$(this).v_play()}),$(e.target).find(".carousel-item.active iframe").resize().css("opacity",1)}))})}();